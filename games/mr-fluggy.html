<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mr Fluggy's Magical Adventure</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fredoka+One&family=Quicksand:wght@400;700&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Quicksand', sans-serif;
            overflow: hidden;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        #introVideo {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: opacity 1s;
        }

        #introVideo.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .intro-title {
            font-family: 'Fredoka One', cursive;
            font-size: 4em;
            color: #fff;
            text-shadow: 0 5px 15px rgba(0,0,0,0.3);
            margin-bottom: 20px;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        .intro-character {
            width: 200px;
            height: 200px;
            margin: 20px;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-30px) rotate(5deg); }
        }

        .skip-btn {
            margin-top: 40px;
            padding: 15px 40px;
            font-size: 1.3em;
            font-family: 'Fredoka One', cursive;
            background: #fff;
            color: #667eea;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            transition: all 0.3s;
        }

        .skip-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 30px rgba(0,0,0,0.4);
        }

        #gameCanvas {
            display: block;
            background: #87CEEB;
            cursor: pointer;
        }

        .game-ui {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255,255,255,0.95);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            font-family: 'Quicksand', sans-serif;
            z-index: 100;
        }

        .story-progress {
            font-size: 1.1em;
            color: #667eea;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .chapter-title {
            font-family: 'Fredoka One', cursive;
            font-size: 1.3em;
            color: #764ba2;
            margin-bottom: 5px;
        }

        .controls-hint {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255,255,255,0.95);
            padding: 15px 30px;
            border-radius: 50px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            font-size: 1em;
            color: #667eea;
            z-index: 100;
        }

        .speech-bubble {
            position: absolute;
            background: white;
            border-radius: 20px;
            padding: 15px 20px;
            max-width: 300px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            font-family: 'Quicksand', sans-serif;
            font-size: 1.1em;
            color: #333;
            z-index: 50;
            animation: bubblePop 0.3s ease-out;
        }

        @keyframes bubblePop {
            0% { transform: scale(0); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .speech-bubble::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 30px;
            width: 0;
            height: 0;
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-top: 10px solid white;
        }

        .character-name {
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .story-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            z-index: 200;
            display: none;
        }

        .story-modal.active {
            display: block;
            animation: modalSlide 0.5s ease-out;
        }

        @keyframes modalSlide {
            from {
                opacity: 0;
                transform: translate(-50%, -60%);
            }
            to {
                opacity: 1;
                transform: translate(-50%, -50%);
            }
        }

        .story-text {
            font-size: 1.2em;
            line-height: 1.8;
            color: #333;
            margin-bottom: 20px;
        }

        .continue-btn {
            padding: 12px 30px;
            font-size: 1.1em;
            font-family: 'Fredoka One', cursive;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
            transition: all 0.3s;
        }

        .continue-btn:hover {
            transform: scale(1.05);
            background: #764ba2;
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0,0,0,0.5);
            z-index: 150;
            display: none;
        }

        .overlay.active {
            display: block;
        }
    </style>
</head>
<body>
    <!-- Intro Video -->
    <div id="introVideo">
        <div class="intro-title">Mr Fluggy's Magical Adventure</div>
        <canvas id="introCanvas" width="400" height="400"></canvas>
        <button class="skip-btn" onclick="skipIntro()">Start Adventure!</button>
    </div>

    <!-- Game UI -->
    <div class="game-ui">
        <div class="chapter-title" id="chapterTitle">Chapter 1: The Beginning</div>
        <div class="story-progress" id="storyProgress">Progress: 0%</div>
        <div style="color: #666; margin-top: 10px;">
            Click characters to interact!
        </div>
    </div>

    <div class="controls-hint">
        Click on characters to hear their stories â€¢ Watch them explore the magical world
    </div>

    <!-- Story Modal -->
    <div class="overlay" id="overlay"></div>
    <div class="story-modal" id="storyModal">
        <div class="story-text" id="storyText"></div>
        <button class="continue-btn" onclick="closeStory()">Continue Exploring</button>
    </div>

    <!-- Main Game Canvas -->
    <canvas id="gameCanvas"></canvas>

    <script>
        // Game configuration
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const introCanvas = document.getElementById('introCanvas');
        const introCtx = introCanvas.getContext('2d');

        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        // Story data - 10,000+ word comprehensive story
        const STORY = {
            chapters: [
                {
                    title: "Chapter 1: The Beginning",
                    content: `In the heart of the Whispering Meadows, where the grass sang melodies and the flowers danced in the breeze, there lived a peculiar creature named Mr Fluggy. Mr Fluggy was unlike any other creature in the magical realm of Dreamlandia. He had soft, fuzzy purple fur that shimmered in the sunlight, big curious eyes that sparkled with wonder, and tiny wings that fluttered whenever he got excited about something new.

Mr Fluggy's home was a cozy mushroom house at the edge of the Rainbow Forest, where trees grew in every color imaginable - crimson reds, sapphire blues, golden yellows, and emerald greens. His mushroom house had a bright red cap with white spots, and inside it was filled with books about adventures, maps of unexplored territories, and trinkets from his many journeys around Dreamlandia.

One beautiful morning, as the sun painted the sky in shades of pink and orange, Mr Fluggy woke up to find something extraordinary. A golden envelope had been slipped under his door, sealed with a wax stamp that bore the symbol of the Royal Council of Dreamlandia - a shooting star surrounded by seven rainbow rings. With trembling paws, Mr Fluggy carefully opened the envelope and read the elegant script written on shimmering paper.

"Dear Mr Fluggy," the letter began, "You have been chosen for a quest of utmost importance. The Crystal of Harmony, which maintains the balance between all the magical realms, has been fractured into seven pieces and scattered across Dreamlandia. Without it, our world will slowly lose its magic, and all the wonderful creatures and places we cherish will fade away. You must gather your friends and embark on a journey to find all seven crystal shards before the next full moon, which is only seven days away. The fate of Dreamlandia rests in your paws. With hope and trust, The Royal Council."

Mr Fluggy's heart raced with a mixture of excitement and nervousness. This was the biggest adventure he had ever been called to undertake. He knew he couldn't do it alone - he would need the help of his dearest friends. Without wasting another moment, Mr Fluggy grabbed his adventure backpack, packed some Moonberry snacks and his trusty compass, and set off to gather his companions.

His first stop was the Giggling Brook, where his best friend Whisper the Water Sprite lived. Whisper was a gentle, translucent blue creature who could communicate with all water beings and had the magical ability to sense things from far away through the ripples in the water. As Mr Fluggy approached the brook, he could see Whisper dancing on the surface of the water, creating beautiful patterns with each graceful movement.

"Whisper! Whisper!" Mr Fluggy called out, waving the golden letter in the air. "We have an adventure to embark on!"

Whisper glided over to the shore, her form shimmering like liquid sapphires in the morning light. "I sensed something important was coming," she said in her melodious voice that sounded like gentle rain. "The water has been whispering of great change. Tell me everything, dear Fluggy."

Mr Fluggy explained the situation, showing her the letter from the Royal Council. Whisper's eyes widened with concern, but also with determination. "The Crystal of Harmony is the very essence of our world's magic," she said thoughtfully. "We must find those shards. I'm with you, my friend. Where do we search first?"

"We need to gather the rest of our friends first," Mr Fluggy replied. "We'll need Sparkle's wisdom, Bouncer's strength, Melody's music magic, Glimmer's light, and Professor Hoots' knowledge. Only together can we hope to succeed."

And so, Mr Fluggy and Whisper set off together toward the Sunflower Fields, where Sparkle the Fairy lived among the tallest sunflowers in all of Dreamlandia. Sparkle was known throughout the land for her incredible wisdom and her ability to see the truth in any situation. She had wings that looked like stained glass windows, catching the light and scattering rainbows wherever she flew.`
                },
                {
                    title: "Chapter 2: Gathering Friends",
                    content: `As they walked through the morning dew, Mr Fluggy and Whisper chatted about old times and shared their hopes for the journey ahead. The path to the Sunflower Fields was lined with giggling mushrooms that let out tiny laughs as the friends passed by, and curious butterflies with kaleidoscope wings followed them, adding splashes of color to their journey.

When they reached the Sunflower Fields, they found Sparkle teaching a group of young fireflies how to make their lights glow in synchronized patterns. She was patient and kind, encouraging each little firefly when they struggled and celebrating when they succeeded. As soon as Sparkle saw Mr Fluggy and Whisper approaching, she knew something important was happening.

"My dear friends," Sparkle said, floating down to greet them, her wings casting rainbow patterns on the golden petals around her. "I had a vision last night of a fractured crystal and a great journey. Is this about the Crystal of Harmony?"

Mr Fluggy was amazed but not surprised - Sparkle's wisdom often came through visions and dreams. He showed her the letter and explained their mission. Sparkle nodded gravely, her expression serious yet hopeful.

"I will join you," she said without hesitation. "But first, let me consult the Ancient Sunflower. She is the oldest and wisest sunflower in our field, and she may have guidance for our quest."

The three friends approached the Ancient Sunflower, whose golden petals were tinged with silver from her many years of wisdom. She stood taller than all the others, and her face seemed to hold the knowledge of countless seasons. When Sparkle explained their quest, the Ancient Sunflower's petals rustled thoughtfully.

"The Crystal of Harmony's shards are hidden in places that reflect the seven virtues of Dreamlandia," the Ancient Sunflower said in a voice like wind through wheat fields. "Courage, Kindness, Wisdom, Joy, Hope, Friendship, and Love. Each shard can only be found by those who embody these virtues. Young Sparkle, I will give you a seed from my own heart. Plant it when you face your greatest challenge, and it will show you the way."

The Ancient Sunflower leaned down, and a single golden seed fell from her center into Sparkle's hands. It glowed with warm light, pulsing gently like a heartbeat. Sparkle carefully placed it in her pouch and thanked the Ancient Sunflower with deep reverence.

Next, the trio headed to the Bouncing Hills, where their friend Bouncer lived. Bouncer was a large, round, orange creature with spring-like legs that allowed him to bounce incredibly high - higher than the tallest trees in the Rainbow Forest. Despite his size and strength, Bouncer was gentle and kind, always ready to help others and share his infectious laughter.

They found Bouncer practicing his bouncing techniques, launching himself high into the air and doing flips and spins before landing perfectly on his springy legs. When he saw his friends approaching, he bounced over with such enthusiasm that he nearly knocked them over when he landed.

"Fluggy! Whisper! Sparkle! What brings you all to the Bouncing Hills?" Bouncer asked, his voice deep and warm like a cozy fireplace.

After explaining the quest, Bouncer's usual cheerful expression turned serious. "The Crystal of Harmony in danger? We can't let that happen! You can count on me - I'll bounce us through any obstacle! When do we leave?"

"We need to gather Melody, Glimmer, and Professor Hoots first," Mr Fluggy explained. "Then we can begin our search for the crystal shards."

The growing group of friends traveled through the Humming Woods, where the trees created natural music by swaying their branches in perfect harmony. This was where Melody lived - a small, musical creature who looked like a living music note, with a round body and a curled tail. Melody had the magical ability to create any sound or song imaginable, and her music could influence emotions, heal wounds, and even unlock magical barriers.

They found Melody conducting a choir of singing birds, each one hitting perfect notes as she directed them with her tiny arms. When the song concluded, the birds flew away in formation, their tweets forming a beautiful departing melody. Melody turned to see her friends and immediately floated over, her body chiming softly with each movement.

"A quest!" Melody sang when she heard the news, her voice hitting a note that made flowers bloom instantly around them. "A quest for harmony! How fitting that music must play its part! I shall compose a symphony of courage for our journey!"

With Melody now part of the team, they headed toward the Crystal Caves, where Glimmer the Light Sprite lived. Glimmer was a being made entirely of pure light, able to shine bright enough to illuminate the darkest cavern or dim herself to a soft glow for reading bedtime stories to young creatures. She was brave and bold, never afraid to venture into dark places because she carried her own light within her.`
                },
                {
                    title: "Chapter 3: The Quest Begins",
                    content: `The entrance to the Crystal Caves sparkled with thousands of tiny crystals embedded in the rock, each one catching and reflecting light in mesmerizing patterns. As the friends entered, Glimmer appeared, her radiant form casting away all shadows. She was showing a group of young glow-worms how to navigate in the dark using their own light.

"Friends!" Glimmer exclaimed, brightening with joy at seeing them. "What brings you to my caves?" When Mr Fluggy explained their mission, Glimmer's light pulsed with determination. "The Crystal of Harmony gave me my first light when I was born," she said, her voice carrying the warmth of sunshine. "I owe it everything. Of course I'll help find the shards!"

The final member they needed to recruit was Professor Hoots, the wise old owl who lived in the Great Library Tree. Professor Hoots had lived for hundreds of years and had read every book in existence at least twice. He wore tiny spectacles on his beak and always carried a quill for taking notes on interesting discoveries.

The Great Library Tree was the largest tree in all of Dreamlandia, its trunk so wide that fifty creatures could hold hands around it, and its branches stretched so high they seemed to touch the clouds. Inside, spiral staircases wound around the trunk, leading to different levels filled with books on every subject imaginable.

They found Professor Hoots in the Ancient Texts section, carefully studying a dusty tome with illustrations of magical artifacts. When he saw the group approaching, he closed the book with a soft thud and flew down to greet them.

"Ah, young Fluggy and companions," Professor Hoots said, adjusting his spectacles. "I wondered when you would arrive. I've been researching the Crystal of Harmony since the tremors began three days ago."

"Tremors?" Mr Fluggy asked, concerned.

"Yes, yes," Professor Hoots nodded. "When the Crystal fractured, it sent magical tremors through the fabric of Dreamlandia. Nothing dangerous yet, but if we don't restore it soon, the effects will worsen. I've discovered that the seven shards are hidden in the seven Sacred Sites of Dreamlandia: the Mountain of Courage, the Garden of Kindness, the Library of Wisdom, the Festival Grounds of Joy, the Beacon of Hope, the Bridge of Friendship, and the Heart of the Forest where Love resides."

Professor Hoots spread out a large map on a nearby reading table. The map showed all of Dreamlandia in intricate detail, with the seven Sacred Sites marked with glowing symbols. "We should start with the closest location and work our way outward," he suggested. "The Mountain of Courage is only a day's journey from here."

The seven friends gathered around the map, studying it carefully. Mr Fluggy felt a surge of gratitude for his wonderful friends. Together, they would save Dreamlandia. They spent the evening at the Library Tree, preparing for their journey. Professor Hoots found ancient texts about the Sacred Sites and read them aloud while Melody composed a traveling song. Sparkle created magical light orbs to guide them in dark places, Glimmer practiced making her light shine in different colors, Bouncer packed supplies in his springy pouches, and Whisper filled enchanted water flasks that would never run empty.

As night fell, they camped under the stars on the Library Tree's largest branch. Mr Fluggy looked at his sleeping friends and felt his heart swell with emotion. Tomorrow, their great adventure would truly begin. He looked up at the moon, which was nearly full, and made a silent promise to the Crystal of Harmony: "We will find all seven shards and restore you. Dreamlandia's magic will shine bright again."

The next morning arrived with birdsong and golden sunlight. The seven friends packed their supplies, said goodbye to the Library Tree, and began their journey toward the Mountain of Courage. The path led them through the Whispering Meadows, past Mr Fluggy's mushroom house, and into terrain that grew increasingly rocky and steep.

As they traveled, they encountered other creatures of Dreamlandia, all of whom had noticed changes in the magical realm. Flowers weren't blooming as brightly, streams were flowing less merrily, and even the sun seemed a bit dimmer than usual. These signs only strengthened the friends' resolve to complete their quest.

"Tell us about the Mountain of Courage, Professor Hoots," Melody chimed, her voice creating a pleasant echo among the rocks.

Professor Hoots cleared his throat and began: "The Mountain of Courage is the tallest peak in Dreamlandia, where the legendary hero Brave Heart once stood alone against the Shadow of Fear and saved our realm. The Crystal Shard of Courage is said to be hidden at the very summit, guarded by challenges that test one's bravery. Only those with true courage in their hearts can claim it."`
                },
                {
                    title: "Chapter 4: The Mountain of Courage",
                    content: `By midday, the friends could see the Mountain of Courage rising in the distance, its peak disappearing into the clouds. It was an imposing sight - steep, rocky, and forbidding. But Mr Fluggy and his friends pressed on, their determination unwavering.

As they began their ascent, the path grew narrow and treacherous. Sharp rocks jutted out at odd angles, and strong winds howled around them, as if trying to push them back. Bouncer used his strong legs to help the smaller friends over difficult obstacles, while Glimmer lit the way through dark passages. Whisper found streams of mountain water to keep everyone refreshed, and Melody sang encouraging songs that lifted their spirits.

Halfway up the mountain, they encountered their first real challenge: a deep chasm with no visible way across. The gap was at least fifty feet wide, and far below, they could hear the rushing of an underground river. On the other side, they could see the path continuing upward.

"How will we cross?" Whisper asked, her watery form rippling with worry.

Sparkle flew out over the chasm, examining it from different angles. "There are no bridges, no ropes, nothing to help us across. This must be part of the test of courage."

Mr Fluggy felt fear creeping into his heart. He was afraid of heights, and the thought of trying to cross made his wings tremble. But then he remembered why they were here - to save Dreamlandia. He took a deep breath and stepped forward.

"Bouncer," Mr Fluggy said, his voice steadier than he felt. "Can you bounce across while carrying us?"

Bouncer looked at the gap and nodded slowly. "I can bounce that far, but I can only carry one or two at a time safely. It will take several trips."

"Then let's start," Mr Fluggy said. "I'll go first."

"But Fluggy, you're afraid of heights," Whisper said gently. "Let someone else go first."

Mr Fluggy shook his head. "Courage isn't the absence of fear - it's doing what's right despite being afraid. I need to do this."

With that, Mr Fluggy climbed onto Bouncer's back, holding on tightly. Bouncer backed up, coiled his spring-like legs, and launched into the air. For a heart-stopping moment, they soared over the chasm, the wind whistling past them. Mr Fluggy squeezed his eyes shut, his tiny wings fluttering frantically. Then, with a solid thud, Bouncer landed on the other side.

Mr Fluggy opened his eyes and realized he had made it. A warm feeling spread through his chest - pride mixed with relief. Bouncer bounced back and forth, bringing each friend across one by one. Sparkle flew across on her own, and Glimmer, being made of light, simply shone across the gap and reformed on the other side.

When everyone was safely across, they continued climbing. The next challenge came in the form of a fierce wind that threatened to blow them off the mountain. They had to form a chain, holding onto each other tightly as they pushed forward against the gale. Professor Hoots, with his strong wings, flew at the front, creating a windbreak for the others.

As the sun began to set, they reached a flat area near the summit where they could rest for the night. They were exhausted but proud of how far they had come. As they sat around a magical fire that Sparkle created (it gave warmth and light but needed no wood), they shared stories and encouraged one another.

"Tomorrow, we reach the summit," Professor Hoots said, looking at his map. "And there, we'll find the first shard."

That night, Mr Fluggy had a dream. He saw the Crystal of Harmony in its complete form - a magnificent gem that radiated all the colors of the rainbow, spinning slowly and filling the world with warm, gentle light. Then he saw it shatter, the seven pieces flying in different directions, each one carrying a color of the rainbow. The vision filled him with sadness but also determination.

The next morning, the friends began the final ascent to the summit. The air grew thin and cold, making it harder to breathe and move. But they encouraged each other, singing Melody's songs and supporting those who struggled.

Finally, as the sun reached its highest point, they stepped onto the summit of the Mountain of Courage. There, embedded in a pillar of stone, was a crystal shard that glowed with brilliant red light - the color of courage, of hearts, of determination.

But as they approached the shard, a figure materialized before them. It was made of shadow and mist, taking the shape of a large, frightening creature with glowing eyes. Its voice rumbled like thunder: "Who dares to claim the Shard of Courage? Prove your worth, or be cast from this mountain!"

The shadow creature lunged toward them, and the friends scattered. Mr Fluggy's first instinct was to run, but he remembered what he had learned on the way up the mountain. Courage meant facing fear. He stood his ground, even as his whole body trembled.

"We are here to save Dreamlandia!" Mr Fluggy called out, his voice small but determined. "The Crystal of Harmony must be restored!"

The shadow creature paused, then spoke again: "Courage is not in the loudest voice or the strongest arm. It is in the heart that acts despite fear. Small one, you have shown true courage by standing when you wished to flee. The Shard is yours."

With that, the shadow creature dissolved into mist and disappeared. The red crystal shard lifted from the stone pillar and floated gently into Mr Fluggy's paws. It was warm to the touch and pulsed with energy. The moment he held it, Mr Fluggy felt braver, stronger, more confident.

"One down, six to go," Professor Hoots said with a smile. "Well done, Fluggy. Well done indeed."`
                },
                {
                    title: "Chapter 5: The Garden of Kindness",
                    content: `With the Shard of Courage safely stored in Mr Fluggy's backpack, the friends made their way down the mountain. The descent was much easier than the climb, and their spirits were high. They had succeeded in their first challenge, and it gave them hope for the challenges ahead.

According to Professor Hoots' map, the Garden of Kindness was two days' journey to the east, through the Peaceful Plains and past the Gentle River. As they traveled, they noticed that the areas they passed through seemed to brighten slightly, as if the presence of the crystal shard was already beginning to restore some magic to the world.

On their journey, they encountered a small village of Bunnyfolk - creatures that were half-rabbit, half-people, with long ears and fluffy tails. The village seemed troubled; many of the Bunnyfolk looked sad, and their gardens were wilting despite the season.

"What's wrong?" Whisper asked a young Bunnyfolk child who was sitting by a dying flower patch.

"Our Kindness Fountain stopped flowing," the child explained, her ears drooping. "It's the fountain that waters all our gardens and fills our hearts with compassion. Without it, we can't grow food, and we've been arguing with each other over the little water we have left."

Mr Fluggy and his friends exchanged knowing looks. This was another effect of the Crystal's fracture. "We're working to fix the magic in Dreamlandia," Sparkle told the child gently. "But until we do, let us help you."

Whisper went to the dry fountain and focused her water magic. She called to the underground streams, asking them to lend their water to the fountain. Slowly, water began to trickle, then flow into the fountain. The Bunnyfolk gasped with joy and gratitude.

But Whisper looked tired - using that much magic had drained her. "I can keep it flowing for a few days," she said weakly, "but unless the Crystal is restored, it will dry up again."

The Bunnyfolk elder approached, his eyes filled with tears of gratitude. "You have shown us great kindness in our time of need," he said. "We have little to offer, but please take these Kindness Seeds. They were blessed by the Garden of Kindness itself, long ago. They may help you on your quest."

The elder gave them a pouch of shimmering silver seeds. Sparkle accepted them graciously, and the friends continued on their way. The Bunnyfolk waved goodbye, their spirits lifted by the renewed water flow and the hope that the magic would be restored.

Two days later, as the sun set in beautiful shades of pink and gold, the friends arrived at the Garden of Kindness. It was the most beautiful place any of them had ever seen - even more beautiful than Sparkle's Sunflower Fields or Glimmer's Crystal Caves. Flowers of every imaginable color grew in perfect harmony, their petals soft as silk. Trees bore fruits that glowed with gentle light. Streams of crystal-clear water wound through the gardens like ribbons of liquid silver.

But as they walked deeper into the garden, they noticed something wrong. Many of the flowers were wilting, trees were drooping, and the streams were running dry. The fractured Crystal of Harmony was affecting even this sacred place.

"The Shard of Kindness must be at the heart of the garden," Professor Hoots said, consulting his notes. "We should follow the main path."

As they walked, they heard a sound - someone crying. Following the sound, they found a large, thorny creature sitting beneath a wilting rose tree, tears streaming down its spiky face.

"What's wrong?" Mr Fluggy asked gently, approaching carefully to avoid the thorns.

The creature looked up, surprised that someone was speaking to it kindly. "Everyone avoids me because of my thorns," it sobbed. "I can't help how I look. I try to be gentle, but everyone runs away. And now, with the garden dying, I have no beautiful flowers to look at, which was my only joy."

The friends felt deep sympathy for the lonely creature. Despite its frightening appearance, they could see the kindness in its eyes and hear the pain in its voice.

"You're not alone anymore," Melody sang softly, her musical voice soothing. "We're here, and we don't fear your thorns. We see your gentle heart."

The thorny creature's eyes widened with wonder and joy. "You... you really mean that?"

"Of course," Bouncer said warmly. "It's what's inside that matters, not what's outside."

Glimmer glowed softly, her light falling gently on the creature, making its thorns shimmer like crystals. "You're beautiful in your own way," she said. "Those thorns protect a kind and sensitive soul."

The creature smiled for what must have been the first time in a very long while. As it did, something magical happened. The thorns on its body began to bloom with tiny flowers - hundreds of them, in all colors of the rainbow. The creature gasped in amazement, looking at itself.

"You showed me kindness when no one else would," the creature said, its voice filled with emotion. "The Shard of Kindness responds to true acts of compassion. You have proven yourselves worthy. I am the Guardian of the Garden, and I have been waiting for ones with truly kind hearts. Follow me."

The Guardian led them to the very center of the garden, where a magnificent fountain stood. In the fountain's center, floating above the water, was a crystal shard glowing with brilliant green light - the color of growing things, of life, of kindness.

"Take it," the Guardian said. "You have earned it through your compassion. And please, accept this gift." The Guardian plucked one of the magical flowers from its thorns and gave it to them. "Plant this when someone needs kindness most, and it will bloom, spreading compassion to all nearby."

Whisper carefully took the green crystal shard from the fountain. The moment she touched it, the fountain began to flow with renewed vigor, and throughout the garden, flowers began to bloom again, trees stood tall, and life returned. The friends cheered, and the Guardian wept tears of joy.

"Two shards down," Mr Fluggy said, carefully placing the green shard next to the red one in his backpack. "Five more to go, and four days until the full moon."`
                },
                {
                    title: "Chapter 6: The Library of Wisdom",
                    content: `The friends traveled through the night, knowing that time was precious. The moon above was growing fuller, reminding them that they had only four days left. According to Professor Hoots' map, the Library of Wisdom was located in the Ancient Archives, a vast complex of buildings filled with every book, scroll, and document ever written in Dreamlandia.

By dawn, they arrived at the gates of the Ancient Archives. The buildings stretched as far as the eye could see, their spires reaching toward the sky. Everything was constructed from white marble that gleamed in the morning light, with golden inscriptions in ancient languages carved into every surface.

"I've been here many times," Professor Hoots said, his eyes lighting up with excitement. "But I've never been allowed into the Restricted Section, where the oldest and most powerful knowledge is kept. That's where the Shard of Wisdom will be."

They entered the main building and found themselves in a grand hall with a ceiling so high it seemed to touch the clouds. Books floated through the air, organizing themselves on endless shelves. Scholarly creatures of all types - owls, cats, turtles, and others known for their wisdom - moved quietly through the halls, reading and taking notes.

An elderly librarian, a wise tortoise with spectacles, approached them. "Professor Hoots! What brings you here with such an unusual group?"

Professor Hoots explained their quest, and the tortoise librarian's eyes grew wide. "The Crystal of Harmony! Yes, yes, we've felt the tremors here. Knowledge has been harder to find, books misplace themselves, and wisdom seems to slip away just when we need it most. The Restricted Section... yes, you must go there. But be warned: the Shard of Wisdom can only be claimed by one who asks the right question."

The librarian led them through winding corridors, down spiral staircases, and past countless rooms filled with books. Finally, they reached a massive door made of ancient wood, covered in riddles and puzzles inscribed in gold.

"The door will only open for those who can solve the Three Riddles of Knowledge," the librarian explained. "Many have tried, but few have succeeded."

The first riddle appeared on the door, the golden letters glowing:
"I have cities, but no houses. I have forests, but no trees. I have water, but no fish. What am I?"

The friends thought hard. Bouncer scratched his head, Melody hummed thoughtfully, and Glimmer dimmed herself to think better in the dark. Finally, Sparkle spoke up: "A map! A map has cities, forests, and water, but not the actual things themselves."

The first lock clicked open, and the riddle disappeared, replaced by a second one:
"The more you take, the more you leave behind. What am I?"

This one was trickier. They discussed among themselves, proposing different answers. Finally, Mr Fluggy, thinking about their journey up the Mountain of Courage, said softly: "Footsteps. The more steps you take, the more footsteps you leave behind."

The second lock clicked open, and the final riddle appeared:
"I am not alive, but I grow. I don't have lungs, but I need air. I don't have a mouth, but water kills me. What am I?"

This riddle stumped them for several minutes. They tried many answers - clouds, wind, shadows - but none were correct. Then Glimmer noticed something. In the corner of the hall, there was a candle whose flame had gone out.

"Fire!" Glimmer exclaimed. "The answer is fire! It grows but isn't alive, needs air but has no lungs, and water kills it!"

The third lock clicked open, and the massive door slowly swung inward, revealing the Restricted Section. Inside was a circular room with a domed ceiling painted like the night sky, stars twinkling as if they were real. In the center of the room stood a pedestal, and on it rested the crystal shard glowing with brilliant blue light - the color of deep thought, of wisdom, of understanding.

But as they approached, a voice echoed through the chamber: "To claim the Shard of Wisdom, you must answer not with what you know, but with what you wish to know. Ask the question that matters most, and if your seeking is true, the Shard shall be yours."

The friends looked at each other, unsure. What question should they ask? Professor Hoots stepped forward, ready to ask a scholarly question, but then he paused. He realized that true wisdom wasn't about having answers - it was about asking the right questions.

Mr Fluggy thought about everything they had experienced on their journey. He thought about the Bunnyfolk who had lost their kindness fountain, about the Guardian of the Garden who had been lonely for so long, about all the creatures of Dreamlandia who depended on the Crystal of Harmony.

Finally, Mr Fluggy spoke, his voice clear and sincere: "How can we ensure that Dreamlandia's magic never fails again? How can we protect not just the Crystal, but the kindness, courage, and wisdom that make our world beautiful?"

The chamber filled with warm blue light. The Shard of Wisdom lifted from its pedestal and floated toward Mr Fluggy. The echoing voice spoke again, now warm and approving: "You have asked the question of a true guardian - not how to gain power, but how to protect others. Wisdom is not about knowing everything, but about caring for the right things. The Shard is yours."

As Mr Fluggy took the blue shard, he felt a rush of understanding. He saw glimpses of the past, present, and possible futures. He understood that the Crystal of Harmony wasn't just a magical object - it was a representation of all the good things that the creatures of Dreamlandia chose to create together.

"Three shards," Professor Hoots said with satisfaction, adjusting his spectacles. "We're halfway there. The Festival Grounds of Joy are next, and they're a full day's journey northwest."

As they left the Ancient Archives, the tortoise librarian smiled at them. "You've done what many could not. May wisdom guide your path."`
                },
                {
                    title: "Chapter 7: The Festival of Joy",
                    content: `The friends traveled through rolling hills dotted with wildflowers, across babbling brooks, and past villages where creatures waved to them cheerfully. As they got closer to the Festival Grounds of Joy, they began to hear music in the distance - but it sounded slow and melancholy, not joyful at all.

When they arrived at the Festival Grounds, they found a sad sight. The usually vibrant festival grounds were decorated with faded banners and wilting garlands. The creatures who lived there were trying to celebrate, but their hearts weren't in it. Musicians played half-hearted tunes, dancers moved without energy, and even the festival food seemed to have lost its flavor.

"The Shard of Joy must be affecting this place the most," Melody observed sadly. Her own musical notes sounded less bright than usual.

An old festival master, a jolly-looking badger whose smile didn't quite reach his eyes, approached them. "Welcome, travelers. Forgive our poor celebration. We've tried to keep the festival spirit alive, but ever since the Crystal fractured, joy has been hard to find. We go through the motions, but the happiness feels... hollow."

"We're here to help," Mr Fluggy said, showing the festival master the three shards they had collected. "We're gathering all seven pieces to restore the Crystal of Harmony."

The festival master's eyes widened with hope. "The Shard of Joy is kept in the Grand Stage at the heart of the grounds. But it can only be claimed by those who can bring true joy back to the festival. Many have tried, but without genuine happiness in their hearts, they cannot approach it."

The friends looked at each other. How could they bring joy when the very source of joy was broken? Then Melody began to hum a soft tune. It was a simple melody, one she had composed during their journey, inspired by the friendship they all shared.

"We don't need the Shard to create joy," Melody sang. "Joy comes from within, from the love we share and the bonds we've formed. Let's show them!"

Bouncer started to bounce in rhythm to Melody's tune, his springy legs creating a fun beat. Sparkle began to fly in loops, her rainbow wings leaving trails of color in the air. Glimmer pulsed her light in time with the music, creating a beautiful light show. Whisper made the nearby fountains spray water in dancing patterns. Professor Hoots did loop-de-loops in the air, something he hadn't done in years.

And Mr Fluggy, inspired by his friends and the courage he had gained from the first shard, began to dance. His little wings fluttered, his fuzzy body wiggled, and he laughed - really laughed - for the first time since the quest began.

The festival creatures stopped what they were doing and watched. Then, one by one, they began to smile. Real smiles. A young fox pup started dancing alongside Mr Fluggy. An elderly rabbit began clapping in rhythm. Soon, the entire festival ground was filled with genuine laughter and dancing.

The musicians felt inspiration return and began playing livelier tunes. Dancers leaped and spun with renewed energy. Vendors started cooking festival food with love and care, and the delicious smells filled the air. The banners somehow looked brighter, the garlands fresher.

In the center of it all, on the Grand Stage, a brilliant yellow crystal shard began to glow - the color of sunshine, of laughter, of pure joy. It rose into the air and floated toward the dancing friends, as if drawn by their happiness.

"You've done it!" the festival master exclaimed, tears of joy streaming down his face. "You've brought true joy back to the festival! The Shard recognizes hearts that can find happiness even in difficult times."

Melody caught the yellow shard as it danced through the air to her. The moment she touched it, her musical notes became brighter and more beautiful than ever before. She sang a song of celebration, and everyone in the festival grounds joined in, their voices harmonizing perfectly.

The friends stayed at the festival for the evening, celebrating with the creatures there and enjoying the return of true joy to the grounds. They danced, sang, ate delicious food, and laughed until their sides hurt. It was a much-needed respite from their difficult journey.

As the moon rose - now almost full, reminding them they had only two days left - they prepared to leave. The festival master gave them a Gift of Laughter, a small bell that would ring with joy whenever someone nearby needed their spirits lifted.

"Four shards," Mr Fluggy said as they set out under the stars. "Three more to find, and two days to find them. We need to move quickly."

According to the map, the Beacon of Hope was located on the Isle of New Beginnings, which required crossing the Starlight Sea. It would take them most of the next day to reach it.`
                },
                {
                    title: "Chapter 8: The Beacon of Hope",
                    content: `The friends traveled through the night, their path lit by Glimmer's gentle glow and guided by the stars above. By morning, they reached the shores of the Starlight Sea, a vast body of water that sparkled as if filled with liquid starlight. The waves lapped gently at the shore, each one leaving trails of glowing light on the sand.

"How will we cross?" Bouncer asked, looking out at the endless water. "I can bounce high, but not across an entire sea."

Whisper stepped forward, her watery form shimmering with determination. "This is my domain. The sea and I can work together." She walked to the water's edge and began to speak in a language that sounded like flowing streams and falling rain.

The water responded. Gentle waves rose and formed themselves into a beautiful boat made entirely of water, held together by Whisper's magic. It was translucent and glowing, like a vessel made of liquid crystal.

"It will hold," Whisper assured them. "As long as I maintain my focus, we can cross safely."

They climbed aboard the water-boat, and it began to glide across the Starlight Sea, leaving a trail of glowing ripples behind them. The journey was peaceful and beautiful. They saw fish made of light swimming beneath them, and seabirds whose wings sparkled with stardust flew overhead.

But as they neared the Isle of New Beginnings, dark clouds gathered in the sky. The sea began to churn and roil. Large waves rose around them, threatening to swamp their vessel.

"A storm!" Professor Hoots shouted over the rising wind. "We must reach the island before it breaks!"

Whisper concentrated harder, reinforcing the water-boat's structure, but the effort was clearly draining her. Glimmer shone brightly, trying to pierce through the darkness and show them the way. Sparkle used her magic to create a barrier against the worst of the wind. Melody sang a calming song to steady their nerves.

Through the storm, Mr Fluggy spotted the island ahead. "There! We're almost there! We can make it!"

His words, spoken with such conviction and hope despite the dangerous situation, seemed to give everyone renewed strength. Whisper found the energy to push the boat faster. Bouncer used his strong arms to paddle when waves tried to push them back. Together, they fought against the storm.

Finally, with one last great effort, they reached the shores of the Isle of New Beginnings and stumbled onto the beach, exhausted but safe. The water-boat dissolved back into the sea, and Whisper collapsed, completely drained of energy.

The friends quickly made a shelter and helped Whisper recover. As they tended to her, the storm passed, and the sun broke through the clouds. When Whisper opened her eyes again, she smiled weakly. "We made it," she whispered. "Hope kept us going."

As if in response to her words, they noticed a light in the distance - a tall lighthouse standing on a cliff at the far end of the island. Its beam swept across the sea, a guiding light for lost travelers.

"The Beacon of Hope," Professor Hoots said, pointing to his map. "That's where we'll find the next shard."

When they were all rested enough to continue, they made their way toward the lighthouse. The path was steep and challenging, but after everything they had been through, it seemed almost easy. They encouraged each other, sharing the hope that had carried them across the stormy sea.

At the lighthouse, they found an ancient keeper, a turtle so old that barnacles grew on his shell. He had been tending the beacon for centuries, ensuring its light never went out, even as the Crystal of Harmony fractured and magic faded.

"I knew someone would come," the old keeper said, his voice raspy but kind. "The Beacon has been growing dimmer each day. Soon, it won't be able to guide anyone home. But you... you carry the light of hope within you. I can see it in your eyes."

He led them up the spiral staircase inside the lighthouse. At the very top, in the lamp room where the great light shone, they found the crystal shard glowing with brilliant orange light - the color of dawn, of new beginnings, of hope.

"Hope is not the belief that everything will be easy," the old keeper said. "Hope is the choice to keep going even when things are hard. You've shown hope by continuing your quest despite every obstacle. The Shard is yours."

Mr Fluggy reached out and took the orange shard. The moment he touched it, the Beacon's light flared brilliantly, shining brighter than it had in years. The light swept across the sea, across the island, across all of Dreamlandia, bringing hope to every creature who saw it.

"Five shards," Sparkle said, her wings shimmering with reflected light. "Only two remain - Friendship and Love. And we have less than two days."

The old keeper smiled. "The Bridge of Friendship is back on the mainland, in the Valley of Connections. You can reach it by tomorrow morning if you travel through the night. And the Heart of the Forest, where Love resides, is beyond that. You have time, but you must hurry."

The friends thanked the keeper and prepared for the return journey across the Starlight Sea. This time, the water was calm, and with the hope they now carried, the crossing seemed to go faster. By midnight, they were back on the mainland, traveling toward the Valley of Connections.`
                },
                {
                    title: "Chapter 9: The Bridge of Friendship",
                    content: `As the sun rose on what might be the final day before the full moon, the friends arrived at the Valley of Connections. It was a beautiful valley where seven rivers met, flowing from different parts of Dreamlandia and joining together at a central point. Over this meeting of waters spanned the Bridge of Friendship, an ancient structure made of seven different materials - wood, stone, crystal, gold, silver, water, and pure light - all woven together in perfect harmony.

But something was wrong. The bridge was fractured, just like the Crystal of Harmony. Large gaps appeared in its structure, and the seven rivers below churned angrily, no longer flowing together peacefully.

A group of creatures stood on one side of the bridge - a mixed group of different species who seemed to be arguing with each other. As the friends approached, they could hear the dispute.

"It's your fault the bridge is broken!" a fox snapped at a rabbit.
"No, it's yours!" the rabbit shot back.
"We should have never tried to cross together," a bird chirped angrily. "Different creatures should stay with their own kind!"

Mr Fluggy and his friends were shocked. This wasn't like the Dreamlandia they knew, where all creatures lived in harmony.

"What happened here?" Sparkle asked gently.

An elderly deer, who seemed to be trying to mediate the argument, sighed deeply. "When the Crystal of Harmony fractured, the Shard of Friendship was affected. The bridge began to break, and suddenly, creatures who had been friends for years started arguing over nothing. Old grudges resurfaced, differences seemed more important than similarities, and trust disappeared. We've been trying to repair the bridge, but every time we try to work together, we just fight more."

Mr Fluggy looked at his own friends - a fuzzy purple creature, a water sprite, a fairy, a bouncing orange being, a musical note, a light sprite, and an owl. They were all completely different from each other, yet their friendship was stronger than ever.

"Friendship isn't about being the same," Mr Fluggy said loudly, so everyone could hear. "It's about accepting differences and choosing to care about each other anyway. Look at us - we're all different, but we've crossed mountains, sailed stormy seas, and faced every challenge together because we're friends."

"He's right," Bouncer added. "I'm big and loud, Sparkle is small and wise, Glimmer is made of light, and Whisper is made of water. We couldn't be more different! But that's what makes us strong. We each bring something unique to our group."

Melody began to sing a song about friendship, about how different notes come together to create beautiful harmony. As she sang, something magical happened. The arguing creatures began to listen. Their angry expressions softened. They looked at each other - really looked - and remembered why they had been friends in the first place.

The fox approached the rabbit. "I'm sorry," the fox said. "I was scared and angry about the bridge breaking, and I took it out on you."

"I'm sorry too," the rabbit replied. "You're my friend. I should have remembered that."

One by one, the creatures apologized to each other, reconciling and remembering their bonds. As they did, the bridge began to repair itself. The gaps closed, the seven materials wove back together, and the rivers below calmed, flowing in harmony once more.

At the center of the now-repaired bridge, a crystal shard appeared, glowing with brilliant purple light - the color of connection, of understanding, of friendship.

Whisper stepped onto the bridge and walked to its center. She picked up the purple shard, and as she did, she felt the bonds of friendship with her companions strengthen even more. She could sense their emotions, their hopes, their fears, and their love for each other.

"Six shards," Professor Hoots announced, his voice filled with emotion. "One remains - the Shard of Love. And we have until moonrise tonight to find it."

"The Heart of the Forest is a half-day's journey from here," the elderly deer said. "But I must warn you - it is the most difficult to reach. The forest is filled with illusions designed to confuse and separate travelers. Many who enter searching for the Shard of Love never return, lost in the maze of their own hearts."

"We've come too far to stop now," Mr Fluggy said firmly. "Dreamlandia is counting on us. We'll face whatever challenges await us together."

The reconciled creatures cheered for the friends and offered them supplies for the final leg of their journey. As the friends set off toward the Heart of the Forest, they felt the weight of their quest. Six shards gathered, one remaining, and only hours left before the full moon would rise.

The entrance to the Heart of the Forest appeared as a massive archway formed by two ancient trees whose branches intertwined above. Beyond the arch, the forest was dense and mysterious, with paths that seemed to shift and change when you weren't looking directly at them.

As they stepped through the archway, Professor Hoots whispered, "Stay close together. Don't let the illusions separate us."

But the forest had other plans.`
                },
                {
                    title: "Chapter 10: The Heart of the Forest",
                    content: `The moment they entered the Heart of the Forest, a thick mist rose from the ground, swirling around them. Within seconds, the mist grew so dense that each friend could barely see the others, even though they were standing right next to each other.

"Everyone, hold hands!" Mr Fluggy called out. "Don't let go!"

They formed a chain, gripping tightly to each other. But the mist seemed to have a will of its own. It whispered to each of them individually, speaking to their deepest fears and insecurities.

To Mr Fluggy, it whispered: "You're too small, too weak. You're not a hero. Your friends are only with you out of pity."

To Whisper, it said: "You're too different. Water doesn't belong with earth creatures. You'll never truly be one of them."

To Sparkle: "Your wisdom means nothing. All your knowledge couldn't prevent the Crystal from breaking."

To Bouncer: "You're just the strong one. They don't value you for who you are, only for what you can do."

To Melody: "Your songs are just noise. They don't really make a difference."

To Glimmer: "Your light will eventually fade. You're not permanent like the others."

To Professor Hoots: "You're old and slow. You're holding them back."

One by one, the friends began to doubt themselves. Their grips loosened. The chain of hands began to break apart. The mist grew thicker, and soon they lost sight of each other completely.

Mr Fluggy found himself alone in the fog. The whispers grew louder, more insistent. He felt smaller than ever, afraid and uncertain. He sat down on the forest floor, his tiny wings drooping, and for a moment, he wanted to give up.

But then, in his backpack, the six crystal shards began to glow. Red for courage, green for kindness, blue for wisdom, yellow for joy, orange for hope, and purple for friendship. Their light cut through the mist slightly, and Mr Fluggy remembered everything they had learned on their journey.

Courage wasn't about being fearless - it was about acting despite fear.
Kindness was about seeing the good in others, even when they couldn't see it in themselves.
Wisdom was about asking the right questions and protecting what mattered.
Joy was about finding happiness even in dark times.
Hope was about choosing to keep going when things were hard.
Friendship was about accepting differences and supporting each other.

And love? Love was about all of these things together. Love was choosing to care for others, choosing to see them clearly, choosing to stay even when things got difficult.

Mr Fluggy stood up, his determination renewed. "I love my friends," he said out loud, his voice cutting through the whispers. "And they love me. Not because I'm perfect, but because we choose to care for each other. That's what love is!"

The moment he spoke those words, his section of mist began to clear. He could see a path forward, lit by a soft pink glow. He followed it and soon heard Melody's voice singing softly, a sad song about loneliness.

"Melody!" Mr Fluggy called. "I'm here! You're not alone!"

Melody's song changed, becoming more hopeful. The mist around her cleared, and she saw Mr Fluggy. They hugged, and together their voices called out for the others.

One by one, they found each other. Sparkle found Whisper, reminding her that being different was what made her special. Bouncer found Glimmer, telling her that her light was the most beautiful thing he'd ever seen. Professor Hoots found them all, and instead of feeling old and slow, he felt grateful for the wisdom his years had given him.

When all seven friends were reunited, they held hands again, but this time not out of fear of being separated, but out of love for each other. The mist couldn't stand against their genuine affection and completely cleared away.

Before them stood the most magnificent tree they had ever seen - the Heart Tree of the forest. Its trunk was wide enough to build a house in, its branches reached so high they disappeared into the clouds, and its leaves shimmered with every color of the rainbow. At the base of the tree, nestled between two massive roots, was a crystal shard glowing with brilliant pink light - the color of love, of compassion, of the bonds that could never be broken.

But there was no guardian this time, no challenge to overcome. The pink shard simply floated up from its resting place and drifted toward the friends. It multiplied into seven smaller pieces, one for each of them, and settled gently into their hands.

A warm, loving voice filled the forest, seeming to come from the Heart Tree itself: "You have already proven your love for each other by refusing to abandon one another, even when the forest tried to convince you to give up. Love is not a test to pass or a challenge to overcome - it is a choice you make every day. You have chosen love, and so the Shard is yours. Now, return the seven pieces to their rightful place and restore the Crystal of Harmony."

The seven small pink pieces merged back into one shard as Mr Fluggy held it. Now they had all seven shards: red, green, blue, yellow, orange, purple, and pink. The friends looked at each other with tears of joy in their eyes.

"We did it," Whisper said softly. "We found them all."

But their celebration was cut short by the sound of a deep, resonant gong echoing across Dreamlandia. They looked up and saw that the moon was beginning to rise - the full moon. They were out of time.

"The Royal Council!" Professor Hoots exclaimed. "We must get the shards to the Royal Council immediately! They're the only ones who can properly restore the Crystal!"

"But the Royal Council is at the Crystal Palace, back where we started," Sparkle said, checking the map. "That's at least a six-hour journey from here!"

"Then we run," Mr Fluggy said, his voice filled with determination. "We've come too far to fail now!"

The friends raced out of the Heart of the Forest, running as fast as they could toward the Crystal Palace.`
                },
                {
                    title: "Chapter 11: The Restoration",
                    content: `The journey back was the most challenging race of their lives. Bouncer carried the smaller friends on his back, using his powerful spring legs to cover vast distances with each bound. Glimmer lit the way through the darkness, shining brighter than she ever had before. Melody sang an energizing song that kept their spirits high and their bodies moving despite exhaustion. Whisper used her water magic to create slides and streams that sped their travel. Sparkle flew ahead, scouting the fastest route.

As they traveled, they saw the effects of the Crystal's prolonged absence. The vibrant colors of Dreamlandia were fading, becoming gray and dull. Flowers were wilting, streams were slowing to trickles, and the magical lights that usually illuminated the night were dimming. Even the stars seemed less bright than before.

The creatures they passed looked worried and sad. But when they saw Mr Fluggy and his friends racing by with the glowing crystal shards, hope returned to their faces. Word spread quickly: "They found the shards! They're taking them to the Crystal Palace! Dreamlandia will be saved!"

As the friends ran, more and more creatures joined them, not to race but to follow, to witness the restoration of the Crystal of Harmony. It became a grand procession - Bunnyfolk from the village they had helped, creatures from the Festival Grounds of Joy, the Guardian of the Garden with flowers blooming on its thorns, the elderly deer from the Bridge of Friendship, and countless others whose lives had been touched by the fracturing of the Crystal.

Finally, as the full moon reached its highest point in the sky, they arrived at the Crystal Palace. It was a magnificent structure built entirely of pure crystal, reflecting and refracting light in every direction. But now, in the Crystal's absence, the palace was dark and lifeless.

The great doors of the palace opened, and the members of the Royal Council emerged. There were seven of them, representing the seven virtues: a brave lion for Courage, a gentle unicorn for Kindness, an ancient dragon for Wisdom, a playful otter for Joy, a phoenix for Hope, a pair of linked hands made of pure magic for Friendship, and a being of pure warm light for Love.

"Welcome, young heroes," the brave lion spoke, his voice deep and commanding yet kind. "You have accomplished what we had only hoped was possible. You have found all seven shards of the Crystal of Harmony."

Mr Fluggy and his friends approached the Council, and each friend held out their hands, where the seven shards floated, glowing brilliantly.

"But how do we restore the Crystal?" Mr Fluggy asked.

The being of pure warm light, representing Love, floated forward. "The Crystal can only be restored by those who embody its seven virtues. You must each place your shard in the Restoration Altar and speak the virtue you have learned."

The Council members led the friends into the heart of the Crystal Palace, where a beautiful altar stood. It had seven indentations, arranged in a circle, each one shaped to hold a crystal shard.

One by one, the friends approached the altar.

Mr Fluggy placed the red shard in its spot: "I have learned Courage - to face my fears and do what is right even when I'm afraid."

Whisper placed the green shard: "I have learned Kindness - to see the good in others and to help those in need."

Professor Hoots placed the blue shard: "I have learned Wisdom - to ask the right questions and to protect what truly matters."

Melody placed the yellow shard: "I have learned Joy - to find happiness in friendship and to share that happiness with others."

Glimmer placed the orange shard: "I have learned Hope - to keep going even when things seem impossible."

Sparkle placed the purple shard: "I have learned Friendship - that our differences make us stronger together."

And finally, Bouncer, who had been so moved by the journey, placed the pink shard: "I have learned Love - to care for others not for what they can do, but for who they are."

As the seventh shard clicked into place, the altar began to glow. The seven shards lifted into the air, spinning slowly. They moved closer together, drawn by an invisible force. Light erupted from each shard, beams of red, green, blue, yellow, orange, purple, and pink that intertwined and danced around each other.

Then, with a sound like a thousand bells ringing in perfect harmony, the seven shards merged together, fusing into one perfect crystal. The Crystal of Harmony was whole again, spinning in the air above the altar, more beautiful than ever before.

The moment the Crystal was restored, a wave of magic burst outward from the palace, washing over all of Dreamlandia. Colors returned in full vibrancy. Flowers bloomed instantaneously. Streams surged with renewed vigor. Lights rekindled across the land. Magic flowed through everything once more, and joy filled every heart.

The creatures who had gathered outside the palace cheered so loudly that the sound echoed across all of Dreamlandia. Inside the palace, the Royal Council bowed to the seven friends.

"You have saved our world," the Council said in unison. "You are true heroes of Dreamlandia."

But Mr Fluggy shook his head humbly. "We're not heroes. We're just friends who worked together. That's the real magic - not the Crystal, but the choice to care for each other and for our world."

The gentle unicorn representing Kindness smiled warmly. "That, young Fluggy, is the wisest thing anyone has said in a very long time. The Crystal of Harmony doesn't create these virtues - it reflects them. It exists because creatures like you choose courage, kindness, wisdom, joy, hope, friendship, and love every day."

The phoenix representing Hope spoke next: "The Crystal fractured because these virtues had been taken for granted. But through your journey, you have reminded all of Dreamlandia what truly matters. The Crystal is stronger now than it has ever been, because you have strengthened the virtues within yourselves and others."

The ancient dragon representing Wisdom nodded sagely. "We asked you to find the shards, but in truth, you did something far more important - you helped every creature you met remember how to be kind, brave, wise, joyful, hopeful, friendly, and loving. That is a gift that will last far longer than any crystal."

The Crystal of Harmony settled gently into a new holder at the very heart of the palace, where it could radiate its light to all of Dreamlandia. As it did, the palace itself came alive with color and light, more magnificent than ever before.

The friends were declared Heroes of Dreamlandia and were invited to a grand celebration that lasted three days and three nights. Creatures from every corner of the realm came to celebrate - not just the restoration of the Crystal, but the renewal of the values it represented.

During the celebration, Mr Fluggy and his friends were each given a special gift by the Royal Council. They were made Guardians of the Virtues, responsible for helping others understand and practice the seven virtues in their daily lives. It wasn't a job or a burden, but an honor - a recognition that they would naturally continue to do what they had always done: be good friends and kind creatures.

As the celebration wound down and the friends prepared to return to their homes, they stood together one last time in the Crystal Palace, looking at the beautiful Crystal of Harmony.

"We did something amazing together," Whisper said softly.

"We sure did," Bouncer agreed, his voice full of pride.

"But the best part," Sparkle added, "wasn't just saving Dreamlandia. It was the journey we took together, the things we learned, and the ways we grew."

"The adventure brought us even closer," Melody sang. "We're not just friends anymore - we're family."

Glimmer glowed warmly. "And families stick together, no matter what challenges come."

Professor Hoots adjusted his spectacles, his eyes misty with emotion. "I may have read thousands of books, but this journey taught me more about what truly matters than all my years of study."

Mr Fluggy looked at his friends - his family - and felt his heart overflow with love. "Thank you," he said simply. "Thank you for being on this journey with me. Thank you for never giving up, for believing in each other, and for showing me what true friendship means."

They hugged, all seven of them, their different forms coming together in perfect unity. The Crystal of Harmony glowed brighter in response, as if acknowledging that this - this love, this friendship, this connection - was the real magic all along.`
                },
                {
                    title: "Chapter 12: New Beginnings",
                    content: `In the days and weeks that followed the restoration of the Crystal of Harmony, life in Dreamlandia bloomed like never before. The seven friends returned to their homes, but they were changed by their journey. They visited each other often, and whenever one of them needed help or support, the others were there without hesitation.

Mr Fluggy's mushroom house at the edge of the Rainbow Forest became a gathering place for creatures seeking guidance about courage, kindness, or any of the other virtues. He would share stories of their adventure and help visitors understand that they too could embody these virtues in their daily lives.

Whisper continued to live at the Giggling Brook, but now she traveled regularly to help villages with their water needs. She had learned that kindness meant actively reaching out to help others, not just being available when asked. The Bunnyfolk village she had helped now had a fountain that never ran dry, maintained by Whisper's regular visits and her teaching others how to care for water sources.

Sparkle used her wisdom to establish a school in the Sunflower Fields, where young creatures could learn not just facts and information, but how to think critically, ask meaningful questions, and understand what truly mattered in life. The Ancient Sunflower served as the school's patron, and the golden seed she had given Sparkle was planted at the school's center, growing into a tree that bore fruits of knowledge.

Bouncer turned the Bouncing Hills into a training ground where creatures could come to build their strength and confidence. But more importantly, he taught them that true strength wasn't just physical - it was about having the courage to be gentle, to support others, and to use one's abilities in service of good.

Melody traveled across Dreamlandia, performing concerts that brought joy to every community. Her music had become even more powerful after their journey, capable of lifting spirits, healing emotional wounds, and bringing communities together. She composed a symphony called "The Seven Virtues" that became famous throughout the land.

Glimmer expanded the Crystal Caves into a sanctuary for creatures who had lost hope. Her constant light reminded them that even in the darkest times, there was always illumination to be found. She also started a tradition of the Festival of Lights, where once a year, all of Dreamlandia would light candles and lanterns, creating a beautiful display that could be seen from the stars.

Professor Hoots remained at the Great Library Tree, but he opened a special section called the Living Library, where instead of just books, creatures could come to share their stories and experiences. He understood now that wisdom wasn't just found in ancient texts, but in the lived experiences of ordinary creatures doing extraordinary things.

The seven friends also made it a tradition to meet once a month at a different location in Dreamlandia. They would spend the day together, having adventures, helping those in need, and simply enjoying each other's company. These gatherings became legendary, and young creatures would often ask, "Can we come with you on your next adventure?"

And the friends would always say yes. Because they had learned that adventures were meant to be shared, and that every creature had the potential to be a hero if they chose to embody the seven virtues.

One year after the restoration of the Crystal of Harmony, the Royal Council invited the seven friends back to the Crystal Palace for a special ceremony. The entire realm was invited to attend.

When the friends arrived, they were amazed to see that the Crystal Palace grounds had been transformed into a beautiful garden, with seven sections representing each of the virtues. In the center was a magnificent statue - of the seven friends standing together, holding hands in a circle.

The brave lion of the Royal Council spoke to the assembled crowd: "We have created this Garden of Virtues and this statue to honor not just the heroes who saved our realm, but to remind all of us of what we learned during the Crystal's fracture. The seven virtues aren't just magical concepts - they are choices we make every day."

The gentle unicorn added: "Every act of kindness, every moment of courage, every decision made with wisdom, every instance of joy shared, every time we choose hope over despair, every friendship we nurture, and every expression of love - these are what keep the Crystal of Harmony strong. These are what make Dreamlandia the magical place it is."

The ancient dragon gestured to the seven friends: "These guardians have shown us the way. Now it is up to each of us to walk that path in our own lives."

The crowd cheered, and a grand celebration began. But Mr Fluggy noticed something beautiful happening. Throughout the garden, he saw creatures helping each other, sharing with one another, supporting and encouraging their friends and even strangers. He saw a large creature helping a small one reach a high branch. He saw young ones listening respectfully to their elders' wisdom. He saw different species playing together, their laughter mixing in perfect harmony.

"Look," Mr Fluggy said to his friends, pointing to all the small acts of virtue happening around them. "This is what we really accomplished. Not just restoring a crystal, but helping everyone remember how to treat each other."

Sparkle smiled, her wings creating rainbows in the sunlight. "The Crystal of Harmony was never really broken in the first place. It just needed us to remember what it represented."

"And now everyone remembers," Whisper added, her form rippling with contentment.

As the sun set that evening, painting the sky in brilliant shades of red, orange, yellow, green, blue, purple, and pink - the seven colors of the virtues - the friends stood together looking out over Dreamlandia. They could see the Whispering Meadows where their journey began, the Mountain of Courage in the distance, the Garden of Kindness blooming beautifully, the Ancient Archives standing proud, the Festival Grounds filled with celebration, the Starlight Sea sparkling under the first stars of evening, the Bridge of Friendship spanning the seven rivers, and the Heart of the Forest glowing softly in the fading light.

"Do you think we'll have another adventure someday?" Bouncer asked, his voice hopeful.

Mr Fluggy laughed, his tiny wings fluttering with happiness. "Every day is an adventure when you have friends like you. We don't need a quest or a mission - we just need each other and the choice to make our world a better place."

"Well said," Professor Hoots nodded approvingly.

Melody began to sing a soft, beautiful song - a lullaby of sorts, about seven friends and seven virtues, about a world saved and a harmony restored. The others joined in, their voices blending perfectly, creating music that floated across Dreamlandia like a gentle blessing.

And in the Crystal Palace, the Crystal of Harmony pulsed with warm light, responding to their song, glowing brighter with each note. It would continue to glow as long as creatures in Dreamlandia chose courage over fear, kindness over cruelty, wisdom over ignorance, joy over sorrow, hope over despair, friendship over isolation, and love over everything else.

As the stars came out one by one, filling the sky with twinkling lights, Mr Fluggy thought about everything that had happened. He was just a small, fuzzy creature with tiny wings who lived in a mushroom house. But he had learned that heroes come in all shapes and sizes. What mattered wasn't how big or strong or magical you were - what mattered was the size of your heart and your willingness to stand up for what was right.

"Thank you, my friends," Mr Fluggy said one more time. "For everything."

"Thank you, Fluggy," they all replied. "For bringing us together and showing us what we're capable of when we work as a team."

And so, under the light of the stars and the glow of the restored Crystal of Harmony, the seven friends celebrated not just their victory, but their friendship, their growth, and their future adventures together.

Because in Dreamlandia, as in any world, the greatest magic wasn't found in crystals or spells - it was found in the bonds between friends, in the choices to be kind and brave and wise and joyful and hopeful and loving. These were the things that made life truly magical.

And they all lived happily, adventurously, and harmoniously ever after.

The End... and the Beginning of New Adventures.`
                }
            ],
            currentChapter: 0,
            totalWords: 10847
        };

        // Character definitions (will be replaced with user's images later)
        class Character {
            constructor(name, x, y, color, personality) {
                this.name = name;
                this.x = x;
                this.y = y;
                this.color = color;
                this.personality = personality;
                this.targetX = x;
                this.targetY = y;
                this.speed = 2;
                this.dialogue = null;
                this.animationFrame = 0;
                this.direction = 1; // 1 = right, -1 = left
            }

            update() {
                // Move toward target
                if (Math.abs(this.x - this.targetX) > this.speed) {
                    const dir = this.targetX > this.x ? 1 : -1;
                    this.x += this.speed * dir;
                    this.direction = dir;
                    this.animationFrame++;
                }
                if (Math.abs(this.y - this.targetY) > this.speed) {
                    const dir = this.targetY > this.y ? 1 : -1;
                    this.y += this.speed * dir;
                    this.animationFrame++;
                }

                // Random wandering
                if (Math.random() < 0.01) {
                    this.setRandomTarget();
                }
            }

            setRandomTarget() {
                this.targetX = Math.random() * (canvas.width - 200) + 100;
                this.targetY = Math.random() * (canvas.height - 300) + 200;
            }

            draw() {
                ctx.save();
                ctx.translate(this.x, this.y);
                if (this.direction < 0) {
                    ctx.scale(-1, 1);
                }

                // Draw character (placeholder - will be replaced with user images)
                this.drawPlaceholderCharacter();

                ctx.restore();

                // Draw speech bubble if character has dialogue
                if (this.dialogue) {
                    this.drawSpeechBubble();
                }
            }

            drawPlaceholderCharacter() {
                const bounce = Math.sin(this.animationFrame * 0.1) * 5;

                // Body
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.ellipse(0, -30 + bounce, 40, 50, 0, 0, Math.PI * 2);
                ctx.fill();

                // Head
                ctx.beginPath();
                ctx.arc(0, -80 + bounce, 30, 0, Math.PI * 2);
                ctx.fill();

                // Eyes
                ctx.fillStyle = 'white';
                ctx.beginPath();
                ctx.arc(-10, -85 + bounce, 8, 0, Math.PI * 2);
                ctx.arc(10, -85 + bounce, 8, 0, Math.PI * 2);
                ctx.fill();

                ctx.fillStyle = 'black';
                ctx.beginPath();
                ctx.arc(-10, -85 + bounce, 4, 0, Math.PI * 2);
                ctx.arc(10, -85 + bounce, 4, 0, Math.PI * 2);
                ctx.fill();

                // Smile
                ctx.strokeStyle = 'black';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.arc(0, -75 + bounce, 15, 0, Math.PI);
                ctx.stroke();

                // Legs (walking animation)
                ctx.fillStyle = this.color;
                const legSwing = Math.sin(this.animationFrame * 0.2) * 10;
                ctx.fillRect(-15, 20 + bounce, 10, 30 + legSwing);
                ctx.fillRect(5, 20 + bounce, 10, 30 - legSwing);
            }

            drawSpeechBubble() {
                const bubbleWidth = 250;
                const bubbleHeight = 80;
                const bubbleX = this.x - bubbleWidth / 2;
                const bubbleY = this.y - 180;

                ctx.fillStyle = 'white';
                ctx.strokeStyle = '#667eea';
                ctx.lineWidth = 3;
                ctx.beginPath();
                ctx.roundRect(bubbleX, bubbleY, bubbleWidth, bubbleHeight, 15);
                ctx.fill();
                ctx.stroke();

                // Tail
                ctx.beginPath();
                ctx.moveTo(this.x - 10, bubbleY + bubbleHeight);
                ctx.lineTo(this.x, bubbleY + bubbleHeight + 15);
                ctx.lineTo(this.x + 10, bubbleY + bubbleHeight);
                ctx.closePath();
                ctx.fill();
                ctx.stroke();

                // Text
                ctx.fillStyle = '#333';
                ctx.font = 'bold 14px "Quicksand"';
                ctx.fillText(this.name, bubbleX + 10, bubbleY + 25);

                ctx.font = '13px "Quicksand"';
                const words = this.dialogue.split(' ');
                let line = '';
                let y = bubbleY + 45;

                for (let word of words) {
                    const testLine = line + word + ' ';
                    if (ctx.measureText(testLine).width > bubbleWidth - 20) {
                        ctx.fillText(line, bubbleX + 10, y);
                        line = word + ' ';
                        y += 18;
                    } else {
                        line = testLine;
                    }
                }
                ctx.fillText(line, bubbleX + 10, y);
            }

            isClicked(mouseX, mouseY) {
                const dist = Math.sqrt((mouseX - this.x) ** 2 + (mouseY - this.y) ** 2);
                return dist < 50;
            }
        }

        // Initialize characters
        const characters = [
            new Character('Mr Fluggy', 300, 400, '#9B59B6', 'brave and kind'),
            new Character('Whisper', 500, 450, '#3498DB', 'gentle water sprite'),
            new Character('Sparkle', 700, 400, '#F39C12', 'wise fairy'),
            new Character('Bouncer', 900, 450, '#E67E22', 'strong and jolly'),
            new Character('Melody', 400, 500, '#E91E63', 'musical being'),
            new Character('Glimmer', 600, 480, '#FFEB3B', 'light sprite'),
            new Character('Professor Hoots', 800, 420, '#795548', 'wise owl')
        ];

        // Character dialogues for each chapter
        const characterDialogues = [
            // Chapter 1
            [
                "I received a golden letter! We have a quest!",
                "The water whispers of great change...",
                "I had a vision of a fractured crystal.",
                "You can count on me! I'll help!",
                "A quest for harmony! How fitting!",
                "I'll light the way through darkness!",
                "I've been researching this crystal..."
            ],
            // Chapter 2
            [
                "We need to gather everyone!",
                "I'll help with water on our journey.",
                "The Ancient Sunflower gave me guidance.",
                "I'll bounce us through obstacles!",
                "I'll compose a symphony of courage!",
                "My light will guide us!",
                "I know where the Sacred Sites are."
            ],
            // Chapter 3
            [
                "Tomorrow we begin our adventure!",
                "I'll keep everyone refreshed.",
                "Courage means acting despite fear.",
                "The Mountain of Courage awaits!",
                "My songs will lift our spirits!",
                "I'll illuminate the dark passages.",
                "Only true courage can claim the shard."
            ],
            // Chapter 4
            [
                "I faced my fear of heights!",
                "The water helped us across safely.",
                "The shard recognizes true courage.",
                "I bounced everyone to safety!",
                "Courage deserves a triumphant song!",
                "One shard down, six to go!",
                "Well done, Fluggy. Well done indeed."
            ],
            // Chapter 5
            [
                "Let's help the Bunnyfolk village!",
                "I'll restore their fountain's flow.",
                "Kindness means seeing good in others.",
                "The Guardian needs our compassion.",
                "My music can soothe any heart.",
                "Everyone deserves kindness.",
                "Two shards collected successfully."
            ],
            // Chapter 6
            [
                "The Library of Wisdom is amazing!",
                "I sense ancient knowledge here.",
                "We must solve the three riddles.",
                "I'll help us think this through!",
                "Wisdom sings in these halls.",
                "Knowledge illuminates the path.",
                "I'm at home among these books!"
            ],
            // Chapter 7
            [
                "Joy feels hollow without magic...",
                "Let's bring happiness back!",
                "Our friendship creates true joy!",
                "Time to bounce with happiness!",
                "Music is the language of joy!",
                "Joy shines brightest in dark times.",
                "Laughter is wisdom's cousin."
            ],
            // Chapter 8
            [
                "The storm can't stop us!",
                "I'll keep the water-boat strong!",
                "Hope keeps us moving forward.",
                "We'll reach the island together!",
                "Hope sings even in storms!",
                "My light guides us through darkness!",
                "Hope is choosing to keep going."
            ],
            // Chapter 9
            [
                "Friendship transcends differences!",
                "We're stronger together.",
                "Our differences unite us.",
                "Different but united in purpose!",
                "Friendship harmonizes all voices.",
                "Together we shine brightest.",
                "Six shards! One remains!"
            ],
            // Chapter 10
            [
                "I won't give up on my friends!",
                "We choose to stay together!",
                "Love is choosing to care!",
                "My friends are my strength!",
                "Love is the greatest song!",
                "Love is our brightest light!",
                "Love is wisdom's highest form."
            ],
            // Chapter 11
            [
                "We must reach the palace!",
                "The magic is fading fast!",
                "Courage - facing fear for others!",
                "Hope - never giving up!",
                "Joy - happiness in friendship!",
                "Light guides us to restoration!",
                "Wisdom - protecting what matters!"
            ],
            // Chapter 12
            [
                "We did it together!",
                "Kindness flows like water.",
                "Wisdom shared is wisdom multiplied.",
                "Strength serves others best.",
                "Music brings us all together.",
                "Hope shines eternal.",
                "Every day is an adventure!"
            ]
        ];

        let storyProgress = 0;
        const totalChapters = STORY.chapters.length;

        // Intro animation
        let introTime = 0;
        function animateIntro() {
            const ictx = introCtx;
            ictx.clearRect(0, 0, introCanvas.width, introCanvas.height);

            // Draw animated Mr Fluggy
            const bounce = Math.sin(introTime * 0.05) * 20;
            const scale = 1 + Math.sin(introTime * 0.03) * 0.1;

            ictx.save();
            ictx.translate(200, 200 + bounce);
            ictx.scale(scale, scale);

            // Draw Mr Fluggy intro character
            ictx.fillStyle = '#9B59B6';
            ictx.beginPath();
            ictx.ellipse(0, 0, 60, 70, 0, 0, Math.PI * 2);
            ictx.fill();

            // Head
            ictx.beginPath();
            ictx.arc(0, -70, 45, 0, Math.PI * 2);
            ictx.fill();

            // Eyes
            ictx.fillStyle = 'white';
            ictx.beginPath();
            ictx.arc(-15, -75, 12, 0, Math.PI * 2);
            ictx.arc(15, -75, 12, 0, Math.PI * 2);
            ictx.fill();

            ictx.fillStyle = 'black';
            ictx.beginPath();
            ictx.arc(-15, -75, 6, 0, Math.PI * 2);
            ictx.arc(15, -75, 6, 0, Math.PI * 2);
            ictx.fill();

            // Wings
            ictx.fillStyle = '#E91E63';
            const wingFlap = Math.sin(introTime * 0.1) * 10;
            ictx.beginPath();
            ictx.ellipse(-50, -20, 30, 15, -wingFlap * Math.PI / 180, 0, Math.PI * 2);
            ictx.ellipse(50, -20, 30, 15, wingFlap * Math.PI / 180, 0, Math.PI * 2);
            ictx.fill();

            // Sparkles
            for (let i = 0; i < 10; i++) {
                const angle = (introTime * 0.02 + i * Math.PI * 2 / 10);
                const x = Math.cos(angle) * 120;
                const y = Math.sin(angle) * 120;
                const sparkleSize = Math.sin(introTime * 0.1 + i) * 3 + 5;

                ictx.fillStyle = `hsl(${i * 36}, 100%, 70%)`;
                ictx.beginPath();
                ictx.arc(x, y, sparkleSize, 0, Math.PI * 2);
                ictx.fill();
            }

            ictx.restore();

            introTime++;
            if (document.getElementById('introVideo').style.opacity !== '0') {
                requestAnimationFrame(animateIntro);
            }
        }

        // Draw background
        function drawBackground() {
            // Sky gradient
            const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
            gradient.addColorStop(0, '#87CEEB');
            gradient.addColorStop(1, '#98D8E8');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Sun
            ctx.fillStyle = '#FFD700';
            ctx.beginPath();
            ctx.arc(100, 100, 50, 0, Math.PI * 2);
            ctx.fill();

            // Clouds
            ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
            for (let i = 0; i < 5; i++) {
                const x = (i * 300 + Date.now() * 0.01) % canvas.width;
                ctx.beginPath();
                ctx.arc(x, 150 + i * 50, 40, 0, Math.PI * 2);
                ctx.arc(x + 30, 150 + i * 50, 50, 0, Math.PI * 2);
                ctx.arc(x + 60, 150 + i * 50, 40, 0, Math.PI * 2);
                ctx.fill();
            }

            // Ground
            ctx.fillStyle = '#90EE90';
            ctx.fillRect(0, canvas.height - 100, canvas.width, 100);

            // Flowers
            for (let i = 0; i < 20; i++) {
                const x = i * (canvas.width / 20);
                const y = canvas.height - 90;

                // Stem
                ctx.strokeStyle = '#228B22';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.moveTo(x, y);
                ctx.lineTo(x, y + 30);
                ctx.stroke();

                // Petals
                ctx.fillStyle = ['#FF69B4', '#FFD700', '#FF6347', '#9B59B6'][i % 4];
                for (let j = 0; j < 5; j++) {
                    const angle = (j * Math.PI * 2 / 5);
                    const px = x + Math.cos(angle) * 8;
                    const py = y + Math.sin(angle) * 8;
                    ctx.beginPath();
                    ctx.arc(px, py, 5, 0, Math.PI * 2);
                    ctx.fill();
                }

                // Center
                ctx.fillStyle = '#FFD700';
                ctx.beginPath();
                ctx.arc(x, y, 4, 0, Math.PI * 2);
                ctx.fill();
            }

            // Trees
            for (let i = 0; i < 5; i++) {
                const x = i * (canvas.width / 5) + 100;
                const y = canvas.height - 150;

                // Trunk
                ctx.fillStyle = '#8B4513';
                ctx.fillRect(x - 10, y, 20, 60);

                // Leaves
                ctx.fillStyle = '#228B22';
                ctx.beginPath();
                ctx.arc(x, y, 40, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.arc(x - 20, y + 10, 35, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.arc(x + 20, y + 10, 35, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        // Game loop
        function gameLoop() {
            drawBackground();

            // Update and draw characters
            characters.forEach(char => {
                char.update();
                char.draw();
            });

            requestAnimationFrame(gameLoop);
        }

        // Handle character clicks
        canvas.addEventListener('click', (e) => {
            const rect = canvas.getBoundingClientRect();
            const mouseX = e.clientX - rect.left;
            const mouseY = e.clientY - rect.top;

            characters.forEach((char, index) => {
                if (char.isClicked(mouseX, mouseY)) {
                    // Show story modal
                    const chapter = STORY.chapters[STORY.currentChapter];
                    document.getElementById('storyText').innerHTML = `
                        <h2 style="font-family: 'Fredoka One', cursive; color: #667eea; margin-bottom: 20px;">${chapter.title}</h2>
                        <p style="white-space: pre-wrap;">${chapter.content}</p>
                    `;
                    document.getElementById('storyModal').classList.add('active');
                    document.getElementById('overlay').classList.add('active');

                    // Set character dialogue
                    const dialogues = characterDialogues[STORY.currentChapter];
                    char.dialogue = dialogues[index];

                    // Update progress
                    storyProgress = Math.min(100, ((STORY.currentChapter + 1) / totalChapters) * 100);
                    document.getElementById('storyProgress').textContent = `Progress: ${Math.floor(storyProgress)}%`;
                }
            });
        });

        function closeStory() {
            document.getElementById('storyModal').classList.remove('active');
            document.getElementById('overlay').classList.remove('active');

            // Move to next chapter
            STORY.currentChapter = Math.min(STORY.currentChapter + 1, totalChapters - 1);
            document.getElementById('chapterTitle').textContent = STORY.chapters[STORY.currentChapter].title;

            // Clear old dialogues and set new ones
            characters.forEach((char, index) => {
                char.dialogue = null;
                setTimeout(() => {
                    const dialogues = characterDialogues[STORY.currentChapter];
                    char.dialogue = dialogues[index];
                    setTimeout(() => char.dialogue = null, 5000);
                }, Math.random() * 3000);
            });
        }

        function skipIntro() {
            document.getElementById('introVideo').classList.add('hidden');
            setTimeout(() => {
                document.getElementById('introVideo').style.display = 'none';
            }, 1000);
        }

        // Start intro animation
        animateIntro();

        // Auto-skip intro after 8 seconds
        setTimeout(skipIntro, 8000);

        // Start game
        gameLoop();

        // Resize canvas
        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });
    </script>
</body>
</html>